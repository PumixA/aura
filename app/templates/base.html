<!DOCTYPE html>
{% load static %}
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Aura - Miroir connecté{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_css %}{% endblock %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
</head>
<body>
<header>
    {% block header %}
    <h1>Aura</h1>
    {% endblock %}
</header>

<main>
    {% block content %}
    {% endblock %}
</main>

<footer>
    {% block footer %}
    <button id="led-button" class="{% if core_settings.leds %}on{% else %}off{% endif %}"></button>
    {% endblock %}
</footer>

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<!-- Vérification de l'initialisation de AX.js si nécessaire -->
<script src="{% static 'js/AX.js' %}"></script>  <!-- Assurez-vous que ce fichier existe -->
<script>
    $(document).ready(function(){
        $('#led-button').on('mousedown', function(){
            anime({
                targets: '#led-button',
                scale: 0.95,
                duration: 100,
                easing: 'easeInOutQuad'
            });
        }).on('mouseup mouseleave', function(){
            anime({
                targets: '#led-button',
                scale: 1,
                duration: 100,
                easing: 'easeInOutQuad'
            });
        });

        $('#led-button').click(function(){
            anime({
                targets: '#led-button',
                backgroundColor: ['#D9D9D9', 'transparent'],
                duration: 300,
                easing: 'easeInOutQuad'
            });

            $.ajax({
                url: "{% url 'toggle_leds' %}",
                type: "POST",
                data: {},
                success: function(data) {
                    if(data.leds) {
                        $('#led-button').removeClass('off').addClass('on');
                    } else {
                        $('#led-button').removeClass('on').addClass('off');
                    }
                },
                error: function(xhr, status, error) {
                    console.error("Erreur lors du basculement des LEDs:", error);
                }
            });
        });
    });
</script>
{% endblock %}
</body>
</html>
